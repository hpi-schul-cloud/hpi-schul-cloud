"use strict";(self.webpackChunkdataport_docusaurus=self.webpackChunkdataport_docusaurus||[]).push([[8404],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>v});var s=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,s,n=function(e,t){if(null==e)return{};var r,s,n={},c=Object.keys(e);for(s=0;s<c.length;s++)r=c[s],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(s=0;s<c.length;s++)r=c[s],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var i=s.createContext({}),l=function(e){var t=s.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},u=function(e){var t=l(e.components);return s.createElement(i.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},h=s.forwardRef((function(e,t){var r=e.components,n=e.mdxType,c=e.originalType,i=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),d=l(r),h=n,v=d["".concat(i,".").concat(h)]||d[h]||p[h]||c;return r?s.createElement(v,o(o({ref:t},u),{},{components:r})):s.createElement(v,o({ref:t},u))}));function v(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=r.length,o=new Array(c);o[0]=h;var a={};for(var i in t)hasOwnProperty.call(t,i)&&(a[i]=t[i]);a.originalType=e,a[d]="string"==typeof e?e:n,o[1]=a;for(var l=2;l<c;l++)o[l]=r[l];return s.createElement.apply(null,o)}return s.createElement.apply(null,r)}h.displayName="MDXCreateElement"},3124:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>l});var s=r(7462),n=(r(7294),r(3905));const c={},o="Access legacy Code",a={unversionedId:"schulcloud-server/Coding-Guidelines/access-legacy-code",id:"schulcloud-server/Coding-Guidelines/access-legacy-code",title:"Access legacy Code",description:"Access Feathers Service from NestJS",source:"@site/docs/schulcloud-server/Coding-Guidelines/access-legacy-code.md",sourceDirName:"schulcloud-server/Coding-Guidelines",slug:"/schulcloud-server/Coding-Guidelines/access-legacy-code",permalink:"/docs/schulcloud-server/Coding-Guidelines/access-legacy-code",draft:!1,editUrl:"https://github.com/hpi-schul-cloud/hpi-schul-cloud.github.io/blob/main/docs/schulcloud-server/Coding-Guidelines/access-legacy-code.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"API design",permalink:"/docs/schulcloud-server/Api"},next:{title:"Code Style",permalink:"/docs/schulcloud-server/Coding-Guidelines/code-style"}},i={},l=[{value:"Access Feathers Service from NestJS",id:"access-feathers-service-from-nestjs",level:2},{value:"Access NestJS injectable from Feathers",id:"access-nestjs-injectable-from-feathers",level:2}],u={toc:l},d="wrapper";function p(e){let{components:t,...r}=e;return(0,n.kt)(d,(0,s.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"access-legacy-code"},"Access legacy Code"),(0,n.kt)("h2",{id:"access-feathers-service-from-nestjs"},"Access Feathers Service from NestJS"),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"FeathersModule")," provides functionality to access legacy code. In order to introduce strong typing, it is necessary to write an adapter service for the feathers service you want to access. Place this adapter within your module, and use the ",(0,n.kt)("inlineCode",{parentName:"p"},"FeathersServiceProvider")," to access the service you need"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-TypeScript"},"// inside your module, import the FeathersModule\n@Module({\n    imports: [FeathersModule],\n    providers: [MyFeathersServiceAdapter],\n})\nexport class MyModule {}\n\n// inside of your service, inject the FeathersServiceProvider\n@Injectable()\nexport class MyFeathersServiceAdapter {\n    constructor(private feathersServiceProvider: FeathersServiceProvider) {}\n\n    async get(): Promise<string[]> {\n        const service = this.feathersServiceProvider.getService(`path`);\n        const result = await service.get(...)\n\n        return result;\n    }\n\n")),(0,n.kt)("h2",{id:"access-nestjs-injectable-from-feathers"},"Access NestJS injectable from Feathers"),(0,n.kt)("p",null,"To access a NestJS service from a legacy Feathers service you need to make the NestJS service known to the Feathers service-collection in ",(0,n.kt)("inlineCode",{parentName:"p"},"main.ts"),"."),(0,n.kt)("p",null,"This possibility should not be used for new features in Feathers, but it can help if you want to refactor a Feathers service to NestJs although other Feathers services depend on it."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-TypeScript"},"    // main.ts\n    async function bootstrap() {\n        // (...)\n        feathersExpress.services['nest-rocket-chat'] = nestApp.get(RocketChatService);\n        // (...)\n    }\n")),(0,n.kt)("p",null,"Afterwards you can access it the same way as you access other Feathers services with\n",(0,n.kt)("inlineCode",{parentName:"p"},"app.service('/nest-rocket-chat');")))}p.isMDXComponent=!0}}]);